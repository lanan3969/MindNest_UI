# 🔐 MindNest 安全配置说明

## ✅ 已保护的敏感信息

本项目已经配置好 `.gitignore`，以下文件**不会被上传到 GitHub**：

### 1. 环境变量文件
```
.env
.env.*
*.env
config.json
secrets.json
credentials.json
```

### 2. 数据库文件
```
mindnest.db
*.db
*.sqlite
*.sqlite3
```

### 3. 缓存和临时文件
```
__pycache__/
node_modules/
Library/
Temp/
Logs/
```

---

## 🔑 API 密钥配置指南

### ModelScope API 密钥

**当前状态**：✅ 安全
- 代码中使用 `os.getenv("MODELSCOPE_API_KEY")` 从环境变量读取
- 没有硬编码在代码中
- 不会被上传到 GitHub

**本地开发配置方法**：

#### 方式1：创建 .env 文件（推荐）
在 `01_Backend_AI/` 目录下创建 `.env` 文件：
```bash
# .env 文件内容
MODELSCOPE_API_KEY=你的真实密钥
```

#### 方式2：系统环境变量
Windows PowerShell：
```powershell
$env:MODELSCOPE_API_KEY="你的真实密钥"
python main.py
```

Windows CMD：
```cmd
set MODELSCOPE_API_KEY=你的真实密钥
python main.py
```

---

## 📋 上传 GitHub 前检查清单

### ✅ 必须确认的项目

- [ ] **检查 .env 文件**：确保没有 `.env` 文件，或已在 `.gitignore` 中
- [ ] **检查数据库**：`mindnest.db` 已在 `.gitignore` 中排除
- [ ] **检查代码**：没有硬编码的 API 密钥或令牌
- [ ] **检查配置文件**：没有包含密码的配置文件
- [ ] **运行清理脚本**：删除 Library、node_modules 等大文件

### 🔍 快速检查命令

在项目根目录运行：
```bash
# 检查是否有 .env 文件
dir /s /b .env 2>nul

# 检查代码中是否有可疑的密钥字符串（可选）
# 如果发现，请确认这些是示例代码还是真实密钥
```

---

## 🚨 如果不小心上传了密钥怎么办？

### 立即行动步骤：

1. **撤销密钥**
   - 立即前往 ModelScope：https://modelscope.cn/my/myaccesstoken
   - 删除或重新生成 API 密钥

2. **从 GitHub 历史记录中删除**
   ```bash
   # 使用 git filter-branch 或 BFG Repo-Cleaner
   # 或者直接删除仓库重新上传
   ```

3. **生成新密钥**
   - 生成新的 API 密钥
   - 在本地 .env 文件中更新

---

## 📤 魔搭创空间部署注意事项

### 在创空间配置环境变量

1. **不要在代码中硬编码密钥**
2. **使用创空间的环境变量功能**：
   - 在创空间设置页面
   - 添加环境变量 `MODELSCOPE_API_KEY`
   - 值设置为您的真实密钥

### 创空间配置示例

```python
# 代码中这样读取（已经正确配置）
MODELSCOPE_API_KEY = os.getenv("MODELSCOPE_API_KEY", "")
```

在创空间平台：
```
环境变量名: MODELSCOPE_API_KEY
环境变量值: sk-xxxxxxxxxxxxx（您的真实密钥）
```

---

## ✅ 当前项目安全状态

### 已确认安全的部分：

1. ✅ **后端代码**（`01_Backend_AI/main.py`）
   - 使用 `os.getenv()` 读取环境变量
   - 没有硬编码密钥

2. ✅ **前端代码**（`02_Mobile_App/`）
   - 没有 API 密钥配置
   - 纯前端展示

3. ✅ **Unity MR**（`03_MR_Experience/`）
   - 没有涉及 API 调用
   - 纯本地运行

4. ✅ **.gitignore 已配置**
   - 排除 .env 文件
   - 排除数据库文件
   - 排除所有敏感配置

---

## 📝 GitHub 仓库说明模板

建议在 GitHub 仓库的 README 中添加：

```markdown
## 🔧 环境配置

### 后端服务需要配置环境变量：

1. 创建 `01_Backend_AI/.env` 文件
2. 添加以下内容：
   ```
   MODELSCOPE_API_KEY=你的ModelScope API密钥
   ```
3. 获取 API 密钥：https://modelscope.cn/my/myaccesstoken

**注意**：请勿将 `.env` 文件上传到 Git 仓库！
```

---

## 📞 安全问题联系

如果发现安全问题或有疑问：
- 检查本文档的检查清单
- 确认 `.gitignore` 配置正确
- 必要时删除 GitHub 仓库重新上传

---

**最后更新**：2026-01-31  
**状态**：✅ 项目已安全配置，可以上传到 GitHub

